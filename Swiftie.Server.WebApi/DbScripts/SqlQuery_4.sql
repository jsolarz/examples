DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Swiftie.Server.WebApi.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201605191453173_Initial'
BEGIN
    CREATE TABLE [dbo].[AspNetRoles] (
        [Id] [nvarchar](128) NOT NULL,
        [Name] [nvarchar](256) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetRoles] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [RoleNameIndex] ON [dbo].[AspNetRoles]([Name])
    CREATE TABLE [dbo].[AspNetUserRoles] (
        [UserId] [nvarchar](128) NOT NULL,
        [RoleId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserRoles]([UserId])
    CREATE INDEX [IX_RoleId] ON [dbo].[AspNetUserRoles]([RoleId])
    CREATE TABLE [dbo].[Stories] (
        [Id] [int] NOT NULL IDENTITY,
        [UserId] [int] NOT NULL,
        [DateCreated] [datetime] NOT NULL,
        [IsDeleted] [bit] NOT NULL,
        [User_Id] [nvarchar](128),
        [UserProfile_Id] [int],
        CONSTRAINT [PK_dbo.Stories] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_User_Id] ON [dbo].[Stories]([User_Id])
    CREATE INDEX [IX_UserProfile_Id] ON [dbo].[Stories]([UserProfile_Id])
    CREATE TABLE [dbo].[Media] (
        [Id] [int] NOT NULL IDENTITY,
        [Url] [nvarchar](max),
        [Type] [int] NOT NULL,
        [Title] [nvarchar](max),
        [Duration] [float],
        [Width] [int],
        [Height] [int],
        [Aspect] [float],
        [ImageType] [nvarchar](max),
        [Duration1] [float],
        [Width1] [int],
        [Height1] [int],
        [Aspect1] [float],
        [VideoType] [nvarchar](max),
        [Discriminator] [nvarchar](128) NOT NULL,
        [Story_Id] [int],
        CONSTRAINT [PK_dbo.Media] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_Story_Id] ON [dbo].[Media]([Story_Id])
    CREATE TABLE [dbo].[Users] (
        [Id] [nvarchar](128) NOT NULL,
        [UserName] [nvarchar](max) NOT NULL,
        [Password] [nvarchar](100) NOT NULL,
        [ConfirmPassword] [nvarchar](max),
        CONSTRAINT [PK_dbo.Users] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[AspNetUsers] (
        [Id] [nvarchar](128) NOT NULL,
        [Email] [nvarchar](256),
        [EmailConfirmed] [bit] NOT NULL,
        [PasswordHash] [nvarchar](max),
        [SecurityStamp] [nvarchar](max),
        [PhoneNumber] [nvarchar](max),
        [PhoneNumberConfirmed] [bit] NOT NULL,
        [TwoFactorEnabled] [bit] NOT NULL,
        [LockoutEndDateUtc] [datetime],
        [LockoutEnabled] [bit] NOT NULL,
        [AccessFailedCount] [int] NOT NULL,
        [UserName] [nvarchar](256) NOT NULL,
        [Discriminator] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUsers] PRIMARY KEY ([Id])
    )
    CREATE UNIQUE INDEX [UserNameIndex] ON [dbo].[AspNetUsers]([UserName])
    CREATE TABLE [dbo].[AspNetUserClaims] (
        [Id] [int] NOT NULL IDENTITY,
        [UserId] [nvarchar](128) NOT NULL,
        [ClaimType] [nvarchar](max),
        [ClaimValue] [nvarchar](max),
        CONSTRAINT [PK_dbo.AspNetUserClaims] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserClaims]([UserId])
    CREATE TABLE [dbo].[AspNetUserLogins] (
        [LoginProvider] [nvarchar](128) NOT NULL,
        [ProviderKey] [nvarchar](128) NOT NULL,
        [UserId] [nvarchar](128) NOT NULL,
        CONSTRAINT [PK_dbo.AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey], [UserId])
    )
    CREATE INDEX [IX_UserId] ON [dbo].[AspNetUserLogins]([UserId])
    CREATE TABLE [dbo].[UserProfiles] (
        [Id] [int] NOT NULL IDENTITY,
        [UserProfile_Id] [int],
        [User_Id] [nvarchar](128),
        CONSTRAINT [PK_dbo.UserProfiles] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_UserProfile_Id] ON [dbo].[UserProfiles]([UserProfile_Id])
    CREATE INDEX [IX_User_Id] ON [dbo].[UserProfiles]([User_Id])
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [dbo].[AspNetRoles] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserRoles] ADD CONSTRAINT [FK_dbo.AspNetUserRoles_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[Stories] ADD CONSTRAINT [FK_dbo.Stories_dbo.Users_User_Id] FOREIGN KEY ([User_Id]) REFERENCES [dbo].[Users] ([Id])
    ALTER TABLE [dbo].[Stories] ADD CONSTRAINT [FK_dbo.Stories_dbo.UserProfiles_UserProfile_Id] FOREIGN KEY ([UserProfile_Id]) REFERENCES [dbo].[UserProfiles] ([Id])
    ALTER TABLE [dbo].[Media] ADD CONSTRAINT [FK_dbo.Media_dbo.Stories_Story_Id] FOREIGN KEY ([Story_Id]) REFERENCES [dbo].[Stories] ([Id])
    ALTER TABLE [dbo].[AspNetUserClaims] ADD CONSTRAINT [FK_dbo.AspNetUserClaims_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[AspNetUserLogins] ADD CONSTRAINT [FK_dbo.AspNetUserLogins_dbo.AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[UserProfiles] ADD CONSTRAINT [FK_dbo.UserProfiles_dbo.UserProfiles_UserProfile_Id] FOREIGN KEY ([UserProfile_Id]) REFERENCES [dbo].[UserProfiles] ([Id])
    ALTER TABLE [dbo].[UserProfiles] ADD CONSTRAINT [FK_dbo.UserProfiles_dbo.AspNetUsers_User_Id] FOREIGN KEY ([User_Id]) REFERENCES [dbo].[AspNetUsers] ([Id])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201605191453173_Initial', N'Swiftie.Server.WebApi.Migrations.Configuration',  0x1F8B0800000000000400E51D6B6FDCB8F17B81FE87C57EBA2B7CBB7E34411AD877F0D9F19DD138366E9DBB7E0B6889BB164E8F3D3D121B457F593FF427F52F941429896F9192562BA7081078F9189233C32167389AF9EFBFFF73FAC35314CE3EC3340B92F86C7EB4389CCF60EC257E106FCEE645BEFEEECDFC87EFFFFCA7D3777EF434FBB56A7782DBA19E7176367FCCF3EDDBE532F31E6104B2451478699225EB7CE125D112F8C9F2F8F0F06FCBA3A3254420E608D66C76FA4B11E74104CB1FE8E745127B709B1720BC497C1866B41CD5AC4AA8B30F2082D91678F06CBEFA12ACF3002E563045D35EFC061FCEB7C182F49BCFCEC300A039AD60B89ECF401C2739C8D18CDF7ECCE02A4F9378B3DAA20210DE3F6F216AB7066106E94ADE36CD6D1775788C17B56C3A56A0BC22CB93C811E0D109C5D252ECDE09D7F31A8B088FEF10BEF367BCEA129767F36B1F9645BF2421428038E0DB8B30C58DCFE637F510E7D9F603CC1755C70501799522705F92F4F7050BF16066DDEFA0E6AAE3C521FE7730BB28C2BC48E1590C8B3C05E1C1ECAE780803EFEFF0F93EF91DC66727470FEB9337AF5E03FFE4F55FE1C92B76A568ADA81D57808AEED2640B533437B8AED73F9F2DF97E4BB163DD8DE943B08278096D90F9EC063CBD87F1267F445BE7F8CD7C76153C41BF2AA1CCF5310ED07E429DF2B4403F3F1461081E4258D72F8D63E2FF0DA31EBF7A3DC8A81FC0E76053925E181F6D9C14EDAB5F6058D6668FC1966C2F8EDE9F68B3AB3489F06F9EBF48EDA75552A41E5E4CA26D720FD20DCCF9D99D2E1BE6B562690C6A78B6AEA04E9FB5F14C65F65636C50BEAB213AA21C6DE0DD57C773BAE35C7ADF2247D36B199E9B05A94BD0F66CA360DEB1CD9B24E8C9634BE24BC8EF39363053E196CE075C29F600C539043FF0EE4394CE366BBB6D19CE735DD7866189768E48B14E2F12B40B8E83E88DC79F03ABB84216420FD9820AE04710F217B03FD0028856CC9239F687D235D996249ACB2752A79DA26ED0DF320D5E23470A9661665552FA14E97DE718B95BD07DE62B3F3870CD57A3995255FE3964B43838C457F5AC958F318187C3D0866B19256A4D47147DE077968BA247599B035839E177E907466D0B2F7D00CFA23C8A088D8B9593E16295534A8704C10DCC18EC9EB086C8CB731238ACADEFB47D16F819F3FF63B857E86C1E631EF07035D39A1973BD149214B304AB90D38F2A6F935F061F74D53F6DE3F4774DA345F37639594D92763911B4A47BEC29D5FFA7D7C3C5D0C63ABC53A614B6AC791EF409621FDDAB8E6C3C35D8C7C91C4EB208D2C26B0532E676D12C35B39A66FE178295BE45D0402D34DDAD67A67310AE5CC0E5AA96673FD0CB2C79D2B012BE8152962A8550EA2EDCE47BB7B4C62F8A1881EF0AE196FACC14873FF25B9427A6792BE8B71AFDEF0DE27DEEF4991BF8B7D6C0CF9987BB26DC412C020D339F73C9865578899A17F911471CF0B8DC5F9B473EBF9450882C86C3E2F4D24553BD97ECE546B0DE86C1B578BCFFB6413C41633ACDA696648AACD33A46D5C678821594C9036D3CCAFAC354F8F3419EC05A2A4C7F0877309F66B3FA1C7362A8F772328C9B703054933D2AF202CF6A68BB16C5BEEFDE177430976FABBA19C262AFE8CD4E3D4EA61AE6A8CC05BB557BFF9B5EF396166636F076E99FB506027F49878BEDD22BE2BB7452F2B860067C776325E155D1A5788DB201AAC03F3DB7CAB8D86C278E9A69A1D9C72DA4BD4551286C9179D2B0783D44F4CCBE62EA56C205DA7D4AD5CEF7B78CD81E6C6C78E50B7534F93561B2759B519EC9994052E3E968A75C6997578382D22F1D994DC33AEB3AB106C1A67B73E4FA9B8DDD002E5638C0E80F019095F765BF094B8815891E69F93CABBCDD9FC50221BD7983ECFD1C647E6C6F45982363E96314F70CC169E6759E2052522159E75D42F8A1F12E9DBB376272959C4129FA61B84D4004B78548217244AA9DB98B827CCCE3DE2797801320FF8F2698896E33B4CAC62468DEC574DEE2FD2984874C2147702D860859FD1833897E56C107BC11684AD58127A5ACA68BCF67A0CB1E6126E618C076CC584CDE06AFF2A3C817A1C81286D183A5D321C676644D677444768A523494361EAE0C493F570B190F7911AA48269A8438791539C1759CA5AF3847891DBB244997395E014CB2352BF0D610E0B54D989DAB6ADD268A4BBB38D2A5054A62ACDCCA80165A7224581A811658A021936A36BFD3BC7102A2AA3A015D1450BE174D851B04B6A66462D18BB67471E5163B3238F8C97C58EC4046C4573C11E3C1D66E4ADD0FBBB6CC9581A9B13394C4C9E11D52AB48EE42DFA347F9DA84D264ED730B3326E3744F76B994A51B799A9A4B50F8D0A51E577BC09764481F17EAA370C74219219748B60E97173256609B48D72B4896A8DBAC4E9E5032E864FB9C2F88046A5F6874CE94F4DC0AE60CEBF06364610A5922C21840722CA5213C046DEB600ADED511228CA582DFDA96224F5A6E52DBD4BD5F448D15D36CCEA7AB720C109ABD583B61122BDE13B80AD5EA18D60E94DCD66C9746FA820723B4E80C56C01799EECF7704C43FD5773E27165651FAA97536F09E9D8B332E7307014BB42BCC5F00BB7400AF7FD8A8C0DAD89A2D548C1CCBBDE78060CA88C120C08F51EEBBA5CB25B74AB95CF82366B45A7B572E29E8150098ADE6B553AB0E8195E6BBFB0B660888BB0627995C141C3F3D51A86C54C25B25A30A352A5AD95E9EE9811745F0D66AA350C8B192A635A10A350EA6CD5BAEE68E1B5B01DCB48CDEB9B8C170B1DC341CB10B1D39C85062C99B50A5B903D91540B41338A947A87B5E6D11B3DA2A6D12EC57BA24577EC9815113B55A437368CC7910322AAF7CF5AD1A8EB4E972458082D385D6AA28A9CDE80ED3688374C94115A325B91102317DFADDC236E4404C6D2E3184E548BEA911007800D146AF107063EBC0AD22CBF04397800F8BDF6C28FA466825AA5B9E95683B19A934CADEADE5BB5C67FD3DB8CF1B33C56E192CD3314DA155A65840D3CA527834290AABBCF70E417108254E13C7191844514EBED4DFADEC41B98ED4F4A6408A74B61FE924949C29B64EFE389604522F974199C5CB53ADB9D647A103AC457963916F53A6B9D1E4AF598CA42D13DB0EE8D84FA43A723E188F1C09D5A9A7EBBD959C310988BD2C082E22AECE131911AB8A535C593611B9D0AAC679AEB0CFF7DBBFEA6DD6BE7DB0EECA39CD0CED807C71BE0780717D8F7278E4E2C0052E200818410E04090A2E159A48F3420EE4C132767F36134B789EB5225247497F183D27C4EDDAFA8E7160722C8BC34888218A0E54D8D34C42D6DE2A4A11F9BB30068913D8CEA6B73164855660FA5FADE9C8552953988F82692018794A6D88ED9A84FE18B6136E2A938716633CB01C9066902A5E35B27207AC67502A3E75C27304CAC041612536CC7BAD4697554D6ED78CBA1B6E7C17681CA9A61B109D4DD76773396F5CEA6D41E5213748085D494DA4392A218B000A5CA6971CF0EEEC8AC5EDBE5AACC3D928EC45634B2000B801639C2603E4E97803175EE6C4AE207A85895D4D843148204B020852A8759B2A100B849B2159DE06930AA6EE1A0A1481FFF73CA8A546B0F5911068005ADA8EE005B3167B1CEE1049623057087B15CBD4B81BD577D50F8687072D24B56EBC4CF1C5FCC9DDB8CA9C9219AF7DD7909D743C563FC4E8847FC8EFA51500363CAE65526F60077E16B8A1D61D1E80212305A3E49BED2FA590CC057C4F1AC1F5F6960E8CF57EEFB7DFE7835061DD0C3E43ECAE7AE30A6A0047A786EDCBB4FE5A27ED51E5443ADBC08BB29AADADEFD44CDAED1CC3FE0CB6F64B553A0CB3358D5C7CAAA851D11149F960B8E843262AC904A20A9BF3660C6759B92F65B87CE74364EA6B9315C67380841FD85B8CD4245178D8E4C402E274E3C40BA583D776AF1CD7AA374447709623006609D6D26457FCD327B935FE3F4E62E56D9DE0EF2534109A3BB5C0F2EA9600EC02C46F7BBC9F18D7EE183B24FED4DD78179EABE5DE589C185707A2C23B824FEBF328CD3A123771C4ECA4CE818D2797E4E8E473A3187E4352A36A9AFC3B4A4FE5D7B8D528FCDF60475920B2769329F55EA1362B8E72C87D1023758ACFE082FC200622365D5E006C4C11A66398992333F3E3C3A1632DB4D27CBDC32CB7C2E76564BAA399E702344D98A3F83D47B04A91CD9AD4726B606A8F441E375ECC3A7B3F93FCB5E6F4B4F68FC57597C8098FB631CFC51A08AFBB480B37FC9E168074AB961F4D59C681E317BAC5EFFE313E97A30BB4DD18E793B3B1470D985C27C7631A7D990AE3D66E398736CF46D146001D51A8EAE5704C67288FE89BD7CF4231F24B1D743E03EA1FA88EAC8D29FECB9C8260AAC78AB62306D39A1A6373F2FD33C1CB37B7D25CCDC24CDAAA8FE4D049EBE7525191B1DB8CB96B867B361F59A8998E0661D26207705C2A5B711D663D39FCF6DD301009FD8A6D31AA47C4983A0F5A83F5E8F7A23B60F84DAE9ADC732A48C41FD50CBBF6C0E7C036C6CA16E62B4EAB703012A3F26BFA83B75E356D142FC4E7981D4D3C499818649FBE3C0AADD52FBBC5CC272996F94500565A77BA29B2EB73455929B5E824799C8A6174445B29AA1E00D82425D329A2EB0B489685477799BC5AA13D374999A36294D97AB994EDCB59F2255CF61CC08BB3D387BA44BF94A3481495935A49423BDC4889C5664D7A7A0C223E6ABCCBA31D8D97B2727D518F4C2B62FD676BA142B1F645EB44419DF8C3331EB968EFE8385E09F4AD4FDDA68BFE760FB63877CB51EF36584D5EF1D499FF19073089EDF95F2BA401383935CF30DAA62209397DD68945668E27C88A30EF1FFBB30CB4064D67CBD303895EDD9C9E0C23076047187FC0A538A1A4E03A96A2634562285B18F0BDD671C0E2FD953CE98302506A3217535131A2B35C2D80CA6FB9E63CA0C669F03614AFCB5EFDBEE3EB8CBFAB6BB57E6527B5A9BAE4395E63D78EC7EE2FA660775C0CB92C6B57317EC212ED6963BCCEEC223738943BA87817864FC0BF4883CE1768F9E14271835A74E4791BDB01859508C7D90B832E1983A96E06A5DBFA18B916D452A52877A95D7705BBE0FE2627D36F71F124478624024A9C0D541BA758335D70DED804D13FDA0559BF681A9A09246A3E5AA2174C1A345D02DF94454A0ED538D68138DA8C0120BAC0B0D5A53919871EF3618D58F8D23D236E6613509044C6353D5C938366D631E5B13A25F45BB5A122A4958D7EA2879A70BEABE8FAC28CAE0FCAA743D2DAA87024A5369FEDAC40209C3654191C2C8AB1E2A250B32D36742994ED88DDEC465332DC71205534C66A265316B46E5C494261EC9C088D845EE92FE88E064A62680C6C088183E55497F348C21B8D4DAFFB0A949241150971B10219905EC604C30F148A7E5EF4E104AFA5BBF8422FD59BE03AA86491F227FF08974A222C6EE88E4D725CC824D03027FC21A438FD386EA36D7F13AA9B43261465513C1D5E206E6C047AAD2799A076BE0E5A81A7B2206F1665E45F87A173D40FF3ABE2DF26D91A325C3E821E478002B77A6F1CB1C29FC9C4F6FB7F85736C412D03403ECC1791BFF5804A15FCFFB4AE1DBA30181B546EA47836999637F9ACD730DE943125B02A2E8AB95DD7B186D43042CBB8D57E033EC3237C481EFE10678CF8D27970E483B2178B49F5E0660938228A3309AFEE827E2613F7AFAFE7F434689EDBEAB0000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201605201346122_userprofile_key'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.Media_dbo.Stories_Story_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[Media] DROP CONSTRAINT [FK_dbo.Media_dbo.Stories_Story_Id]
    IF object_id(N'[dbo].[FK_dbo.Stories_dbo.Users_User_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[Stories] DROP CONSTRAINT [FK_dbo.Stories_dbo.Users_User_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_User_Id' AND object_id = object_id(N'[dbo].[Stories]', N'U'))
        DROP INDEX [IX_User_Id] ON [dbo].[Stories]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Story_Id' AND object_id = object_id(N'[dbo].[Media]', N'U'))
        DROP INDEX [IX_Story_Id] ON [dbo].[Media]
    ALTER TABLE [dbo].[Stories] ADD [ImageUrl] [nvarchar](max)
    ALTER TABLE [dbo].[Stories] ADD [ImageWidth] [int] NOT NULL DEFAULT 0
    ALTER TABLE [dbo].[Stories] ADD [ImageHeight] [int] NOT NULL DEFAULT 0
    ALTER TABLE [dbo].[Stories] ADD [ImageAspect] [float] NOT NULL DEFAULT 0
    ALTER TABLE [dbo].[Stories] ADD [ImageType] [nvarchar](max)
    ALTER TABLE [dbo].[Stories] ADD [VideoUrl] [nvarchar](max)
    ALTER TABLE [dbo].[Stories] ADD [VideoDuration] [float] NOT NULL DEFAULT 0
    ALTER TABLE [dbo].[Stories] ADD [VideoWidth] [int] NOT NULL DEFAULT 0
    ALTER TABLE [dbo].[Stories] ADD [VideoHeight] [int] NOT NULL DEFAULT 0
    ALTER TABLE [dbo].[Stories] ADD [VideoAspect] [float] NOT NULL DEFAULT 0
    ALTER TABLE [dbo].[Stories] ADD [VideoVideoType] [nvarchar](max)
    ALTER TABLE [dbo].[Stories] ADD [AudioUrl] [nvarchar](max)
    ALTER TABLE [dbo].[Stories] ADD [AudioDuration] [float] NOT NULL DEFAULT 0
    ALTER TABLE [dbo].[Stories] ALTER COLUMN [UserId] [nvarchar](max) NULL
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Stories')
    AND col_name(parent_object_id, parent_column_id) = 'User_Id';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Stories] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Stories] DROP COLUMN [User_Id]
    DROP TABLE [dbo].[Media]
    DROP TABLE [dbo].[Users]
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201605201346122_userprofile_key', N'Swiftie.Server.WebApi.Migrations.Configuration',  0x1F8B0800000000000400ED5D596FE4B8117E0F90FF20F4D3EEC2DBED23339818ED5D787CEC1A191F98F6CCE6CDA025765B181DBD3A666C04F96579C84FCA5F082951126F51125BDDDE040B2CDC22F955B1AA4856F1A8F9CFBFFE3DFFF9390C9CAF3049FD383A991C4CF7270E8CDCD8F3A3D5C924CF963FBE9BFCFCD39FFF34BFF0C267E77355EF08D7432DA3F464F29465EBE3D92C759F6008D269E8BB499CC6CB6CEAC6E10C78F1EC707FFFAFB383831944101384E538F38F7994F9212C7EA09F6771E4C2759683E03AF6609092EFA86451A03A372084E91AB8F064B2F8E62F331F4E1730416C4F7F838FA76B7F5AB69B38A7810F104F0B182C270E88A2380319E2F8F8530A17591247ABC51A7D00C1FDCB1AA27A4B10A490F4E4B8A96EDAA9FD43DCA959D3B08272F3348BC38E800747444A33BE792F594F6A2922395E2079672FB8D7852C4F26571E2C3E7D8C0324009EE0F15990E0CA2793EB9AC469BABE81D9B46A382D212F1304F72D4EBE4C69C43DC7B8DD5E6D5587D37DFCDF9E739607599EC09308E65902823DE72E7F0C7CF76FF0E53EFE02A393A383C7E5D1BB376F8177F4F62FF0E80DDD53D457548FF9803EDD25F11A268837B8ACFB3F71666CBB19DFB06E46B529A5826C090D9089730D9E3FC068953DA1A173F86EE25CFACFD0ABBE10E3FA14F9683CA1465992A39F37791080C700D6E5332D4DFC7F0DD5C3376FAD50BD015FFD55A17A8E3E1A38091A571F615094A64FFEBA1C5E8CBE1F48B5CB240EF16FD6BECAD287459C272EEE4CACAC720F9215CC58EEE6B3C6788D4C1A43D937EB0A75F74D1B732A9AB7B42AEE509F915091187B3454FC6E96AEB1C52DB23879D199996EB19A16ADF71C699DC6740E4C4D27425D1A7F26BC8AB2A343893C2969E07EC25F6004139041EF0E64194CA266B8B6E9BCD5D6D09F463AD7933947CC9D2510B358D1C29FEEFDB0BB995EA5E7308014D2FB18192E88BA038560053F25C1C67B5F10FACDF7B2A736C51AE0FC0AFDD553660108CDAFD0AD81CE6364F03D94819130C2C685F8D9F7603C86B60A42E779429CC341E229B02C68BEC0B1A1F902C88AE60BA4E27FA3A8FF34F7FC51D45F10EAA5FE5EBE947D3F6AF77DA8D7121E5C84C0D7199C697C60400505E94B3F09872F6A77204D916ABD5F41FAB4F1B1B2806E9E20835A64205C6F9CDADD531CC19B3C7CC4A3663C5AD65473FF2DBE042EF2D72E22DC6A30DE87D8FD12E7D945E4615FEA53E68AAE95218015764E5D17A6E9253266E89DC5793470A5C253D9B6E3F3B300F8A13E40C76C3E54F5C4089D2A5686E8741D598CAEE3F043BCF223030EAB7A0A0ECB623D87A44E570E31920183A49A82BFA254CF5E59C5DA1E47A10FFB8B7301FB475FA177206CDD904750A86F147FB7A0F41904B96D52BD464331F6ED8F860276F74743C126FAFC15453B89D1D65F5519C11BD597EF2AB68F398EB3B18703D3CDB1898F3307180F97D3F51AD95D312CDAE23AEDC6258763790BD3790F5248B8E0D760AEE3420F711DA483A5AFDFFDD7F68EC2F8FFE6ACB91375190741FC4D75584409F581AAD9F852D20A823B25AFD5D5DFC37DF6151E1F4DA1AE276793146B99ACEA7465B134F616FECA4A72E60A8753C75951A18B2F7A9AA6B1EB17FC48CE90C90920DB3D14F739EDC781E2502F4FEFAED198F2F14C83BEA0A972C28F96DBA8DC65774EDDF28CFD0CA42EF0C4591975C8EBC0582514C51C2463EE0781261AC230C18D00DE3849D1A4E0479938DEFDC8F5D720689512D7D270AEC07DAF69F025E7700D234CB0551226C4E5278998819A0EA7943609CD6794C59919221DE9B6295C1AF6AA569D514D51166C2B382321E0468D5122A811AD51220C13EACA33F0D1CD916C6B18299DDFE3D81D73E47656149C91186CF3E6C80A6A6C736485F1BACCB1DCC432D239B7A3B53BC6C8EEA36D6F9916A534B6253292D879439407012A95B744048DD699A08F55F8FE747A20E8BC8D84C4B034247EE0BDE75EE2A8420D134E85B8C3B628F8A08522406E3C6D4204C56C62C21E1BDAF451921EBA65626917AC520065608586518606114CE85B64E78FF8337CCE24FB16882AD9BA48C98610DF170CBB80197B9ED18471D2F04A10080BC2CFA53AC066BE6D01AD236A018A18564B7B72CD54CB48A79E55C7625A44E2657780ADCEB2B4B0C45B32E932B14F192263F51C166586229FF4BD5DAAA2FA762FBF641845F775776AB314961EA3609CC2915826EF49B01DEF2014E6AC542D1565A0691C6A52FD213A30908B2C325408A6EA835DC95476DD221959CC631CF5F4970C17A4282453F5C1AE648821B60846E27D9BFADFFDC5C2BACB1B1E488A8D5E512E06CE60077790974E33616AA4A477FF4C21070AA95E12F522923A88C62EE260F1F02E21055877C0AA58CA955C2F13D16334F319074B837113DB06A64610D5567BED11D665F359F9F28D7C98CF144FE4E6D760BDF6A315F5648E7C7116E57BB9B31F17DD9F8F8525C6CC650C8EF75F6B4AC802C00A72A58834E2F4D24FD2EC1C64E011E093A7332F14AA71FEAFC21DAA88D12EAEA8ADCA39AA6AE3BF89EBA93BF3633C63318E266897A897218EC48B4333C9442A6FEEE0678C200089E49CEE2C0EF230526F0CA85B9717CFE8F6E51711613EE3F817627F416EC2C60CAB04231589AB8B7575D571477F95A9215482AFB65068D1ABB655D428D579098DA23A43D99A0AD58B4E4FC595515E776D29DA6D6664D95130F39E8886620ACCF1A837454CD79ACF1DB0EA67450C54FDB52312793D226091EF1DD1AA3724025C55D011AF7A4A22E055051DF1CABB75025AF9D91CAB792C4443355F3B2235CF4104B8A6A823A644AFF4F78E6832BD32051DF1647A650A3AE2510F850448AACC1CB5790F44E3355F3B22C935CC15EDCCD2A1DA32522F1C5729FEFB76F99DF1D2FFFDC0757FAC05853CD2A101C8A78E18D43B0F018C2A3347659FE2D0986C893922F7DE8686E48A3A7049BFAA6198A40B7AE129242AAF614E417C4743A38BA5E6C892173534B4A4B807B68467BEACC3E4253EBA612630B1B89BAB260642CD57FBD3E110EF97BF7FBB73B317B275CF2F8EE78A6BFD921BC38C23EBA76EE2877E041097BB266BBDA4764ED0EC01D6A852B610DE2B4F422C28AF3C7C1BA64105C62E878FD4331E1A88FADC118B3CD411C0C8F79DB42BE5399205BB2A4F5F87D9950243BDBE324F61D8E555FB7E478DC9BC6F615C18DDFB1E355E37EBDD667051EFDA5B330FFA28BDBB61685B0F9B6A362D66F6804294B5E440AFBB48E9D61D64878F602436AA3C0A14856724781A537E418EE2A32F8BCA8B7ABD6D43CB56E3655CA5F80D50FDFEC7BCE3FCE1D520F3A94F0A7B184FDDD6686BB84523DCF1E8EE990C77DCFABF6A30A537DCC35ACA86F66619FAC07780B5D83613FA547BE76CA497710827E27C957A29AC4FC6B913F039398D6ECF242B1C4F9755264EE53A21837B4933184E7185E9E2F7E02CF021DEA0A82A5C83C85FC2342BDF784E0EF70F0EB914B4BB930E7696A61EF304B525272CABB8111EAB465F41E23E81447C203D20656A032ADCAABD8A3CF87C32F947D1EAB8B8E581FF2A3EEF21E3FE14F9BFE7A8E03EC9A1F34F31AB8BFD445B7DE5AEF2CF3796F0D35CAA577F7F289BEE39B7091A31C7CE3E27CB3E1A66D38076E2A66C3A809B8EC941471F463E9EA05A5F750F4A645009FCBB103C7F4F63F5CCB3E9A11F99953C9B8F7E3638C7E6A0DE8979340B7D0CCFA2D91B86CDA4B80C62D01388CE293348467C9ACCE1607C2EC47EBD143361F611BA240F666F181BBA9327C11C24733ED1E570303B0AE423134AFA86EB54D39A5D21745DEA9753F3F5BA574CCA49292AE71EF5CF30D9673A9765971C64A0D20C9283102559226DE15911A12A0B641F2C650648D9A26FD2597946C83EAC29B341F699AF9B33E7AE4E69D5D24EE02171B8D803C441B3C1803C857F6447785B719090EB6FD03422E6F3EB003720675F0FCB7865E9EEACADBD7762363B6BD8DB346D63EB516EE1BEEA19657CA755CEC7C300FD0BE4D506603E7B58CB39B62B69C6EA6DBE2D67171B3B538931CD5799476C97B2E39064055B4E1836B67DA96E8975D82CDFE5CC60BB6460246DC59653808D6D60AAEB62BB6C60E6B9BE76C9BEB6BD3C6EC3BA8C97C7AD1A9741CA06F98379FB39AACAD3F5BEC99F7AD987FE76A075F3E03B6B6A1DFA1B49235B4987B466966C84E491EA98B2EC95D884EAF9F42BB004C9A1C7C0A5C87CB21879A2187B21E96A849A9B68D68D82BBCD55ED340A8941782D923B7BB28B496D79EDCA5B5C2713EF31468A2F771CCA7FB4439EE34845AC713794049B2A6AA2559D76C264A212A891EF3212AADC3BBA3EB5A6CFD3F7A51B31126F6A29923A7AB28A7C663ADA2414D1D22675F4B41519C378DACCCC2250654A65F4A80A22AD6D64F293E60A93A5796C71E525284DA1FE82680721D07B365633F7293B602C066610281EA75916C42612F50D1704332215AFA92C0BC27E5EBEE162186358C86335BB79F884DC67F5778D208420CE0C6307B3ECF5EA3EB3C8530F58EC76B734C741D9F3869B7C0F51D9C99527BE00401E6C1EE1DB26E5AF7398FAAB0602BF6988A0CBF8AE759DAB6819573E34C75155853B49BB8619F090637B9A64FE12B8192AC6174D8A7FFB8B3CF7BE081FA17715DDE6D93ACF509761F8183036805D711DFD222120CBF3FC765DFC5B4136BA80D8F4F1059DDBE87DEE075ECDF7A5E4E85601817D7C724C8A7599E1E3D2D54B8D7413478640447C7568720FC37580C0D2DB6801BEC23EBC210BFC0057C07D690EEA5520ED8A60C53E3FF7C12A01614A309AF6E827B2612F7CFEE9BF52E613FD78890000 , N'6.1.3-40302')
END

